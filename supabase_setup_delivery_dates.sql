-- ============================================
-- ШАГ 1: СОЗДАНИЕ ТАБЛИЦЫ ДЛЯ ДАТ ДОСТАВКИ
-- ============================================
-- 
-- ИНСТРУКЦИЯ:
-- 1. Откройте ваш Supabase проект: https://supabase.com/dashboard
-- 2. Перейдите в раздел "SQL Editor" (слева в меню)
-- 3. Скопируйте весь этот файл и вставьте в SQL Editor
-- 4. Нажмите кнопку "Run" (или F5)
-- 
-- ============================================

-- Создаем таблицу для хранения дат доставки
CREATE TABLE IF NOT EXISTS delivery_dates (
    id BIGSERIAL PRIMARY KEY,
    city_name TEXT NOT NULL UNIQUE,
    delivery_date TEXT NOT NULL, -- Формат: "9.02" или "12.02"
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Создаем индекс для быстрого поиска по названию города
CREATE INDEX IF NOT EXISTS idx_delivery_dates_city_name ON delivery_dates(city_name);

-- Включаем Row Level Security (RLS) для безопасности
ALTER TABLE delivery_dates ENABLE ROW LEVEL SECURITY;

-- Создаем политику: все могут читать (anon), но только админы могут изменять
-- (это нужно будет настроить отдельно через Service Role, если нужно)

-- ============================================
-- ШАГ 2: ЗАПОЛНЕНИЕ НАЧАЛЬНЫМИ ДАННЫМИ
-- ============================================
-- 
-- Вставляем города из вашего списка с датами
-- Вы можете изменить даты на актуальные

INSERT INTO delivery_dates (city_name, delivery_date) VALUES
    -- Группа 1 (с 9.02)
    ('Москва', '9.02'),
    ('Тула', '9.02'),
    ('Калуга', '9.02'),
    ('Рязань', '9.02'),
    ('Тверь', '9.02'),
    
    -- Группа 2 (с 8.02)
    ('Санкт-Петербург', '8.02'),
    ('Питер', '8.02'), -- альтернативное название
    ('Великий Новгород', '8.02'),
    
    -- Группа 3 (с 12.02)
    ('Воронеж', '12.02'),
    ('Белгород', '12.02'),
    ('Липецк', '12.02'),
    ('Тамбов', '12.02'),
    ('Орёл', '12.02'),
    ('Курск', '12.02'),
    
    -- Группа 4 (с 9.02)
    ('Казань', '9.02'),
    ('Ульяновск', '9.02'),
    ('Чебоксары', '9.02'),
    ('Йошкар-Ола', '9.02'),
    ('Набережные Челны', '9.02'),
    
    -- Группа 5 (с 8.02)
    ('Нижний Новгород', '8.02'),
    ('Владимир', '8.02'),
    
    -- Группа 6 (с 8.02)
    ('Краснодар', '8.02'),
    ('Ставрополь', '8.02'),
    ('Майкоп', '8.02'),
    ('Черкесск', '8.02'),
    
    -- Группа 7 (с 5.02)
    ('Ярославль', '5.02'),
    ('Кострома', '5.02'),
    ('Иваново', '5.02'),
    ('Вологда', '5.02'),
    
    -- Группа 8 (с 6.02)
    ('Екатеринбург', '6.02'),
    ('Челябинск', '6.02'),
    
    -- Группа 9 (с 6.02)
    ('Новосибирск', '6.02'),
    ('Кемерово', '6.02')
    
ON CONFLICT (city_name) DO UPDATE 
SET delivery_date = EXCLUDED.delivery_date,
    updated_at = NOW();

-- ============================================
-- ПРОВЕРКА: Посмотреть все добавленные данные
-- ============================================
-- Раскомментируйте строку ниже, чтобы увидеть все города и даты:
-- SELECT * FROM delivery_dates ORDER BY city_name;
